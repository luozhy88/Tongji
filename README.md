# Tongji


多重比较校正的主要目的是控制假阳性率，以提高统计检验的可靠性。其原理基于以下几个关键概念：

## ****假阳性率与多重比较

在进行多次假设检验时，假阳性率（Type I error rate）会随着检验次数的增加而上升。例如，如果每次检验的显著性水平设定为0.05，那么在进行100次独立检验时，预期会有5次假阳性结果。这种情况在生物统计学中尤为常见，因为在基因组研究中，通常需要对成千上万的基因进行比较。

## ****控制假阳性率的方法

### 1. **家庭错误率（Family Wise Error Rate, FWER）**

FWER是指在所有比较中至少出现一次假阳性的概率。为控制FWER，可以采用**Bonferroni校正**，即将显著性水平$$\alpha$$除以比较次数$$m$$，从而设定每个检验的显著性水平为$$\alpha/m$$。这种方法虽然保守，但能够有效减少假阳性。

### 2. **错误发现率（False Discovery Rate, FDR）**

FDR是指在所有被认为显著的结果中，实际为假阳性的比例。Benjamini和Hochberg于1995年提出了一种控制FDR的方法，该方法不那么严格，允许一定比例的假阳性存在，从而提高检验的灵敏度。

- **Benjamini-Hochberg (BH) 方法**：该方法首先将所有p值从小到大排序，然后计算每个p值对应的临界值。具体步骤如下：

  - 对于每个排序后的p值 $$ p_i $$，计算其临界值 $$ \frac{i}{m} \cdot \alpha $$，其中 $$ m $$ 是总比较次数，$$ i $$ 是当前p值的排名。
  
  - 找到最大的 $$ i $$ 使得 $$ p_i \leq \frac{i}{m} \cdot \alpha $$，然后拒绝所有零假设对应的p值小于等于该临界值。

这种方法通过设置不同的阈值来控制FDR，使得整体假阳性率保持在可接受范围内。

FDR（假发现率）和q值之间的关系密切，二者在统计分析中都用于处理多重比较问题，尤其是在基因组学等领域。以下是对FDR和q值的详细解释及其关系。

## ****FDR的定义

FDR是指在所有被称为显著的发现中，预期为假阳性的比例。它可以用以下公式表示：

$$
\text{FDR} = \frac{V}{R}
$$

其中，$$ V $$ 是假阳性（错误拒绝的零假设数量），而 $$ R $$ 是所有被拒绝的零假设数量（即所有被认为显著的结果）。

## ****q值的定义

q值是每个特定检验的FDR的估计值。具体来说，q值是指在给定p值的情况下，预期在所有显著结果中有多少比例是错误发现。q值可以被理解为控制特定假设检验的FDR的一种方式。

### q值与FDR的关系

- **q值作为FDR的具体化**：对于每个基因或检验，q值表示在该检验被认为显著时，预期会有多少比例的假阳性。例如，如果某个基因的q值为0.03，这意味着在所有与该基因相关的显著结果中，预计有3%是错误发现。

- **计算方式**：q值是通过对p值进行排序并计算相应的FDR来得到的。具体而言，可以通过以下步骤计算q值：
  1. 对所有p值进行排序。
  2. 计算每个p值对应的FDR。
  3. q值就是对于特定p值，其对应的最小FDR。

- **决策依据**：在进行多重比较时，研究者通常会设定一个q值阈值（例如0.05），以决定哪些结果可以被认为是显著。若某个结果的q值低于设定阈值，则可以将其视为显著发现。

## ****总结

总之，FDR和q值都是用于控制多重比较中的假阳性率的重要工具。FDR提供了一个总体框架，而q值则为每个单独检验提供了具体的假阳性预期。这种方法允许研究者在进行大量假设检验时，更加灵活地评估结果的显著性，并减少由于多重比较引起的错误发现。
